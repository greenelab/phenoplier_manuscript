### Clusters of traits in the gene module space are affected by shared transcriptional processes

::: {style="color: red"}
In the previous section, we showed that projecting TWAS to this latent space
show expected traits associations and cell types.

The idea of this section is to use this latent space to find:

- which traits are affected by the same transcriptional processes, and
- the context (cell types/tissues) in which those processes are activated.

For the clustering analysis approach, we used a consensus clustering approach to
increase robustness of results:

- a **PCA** and a **UMAP** projection of the data (traits x LVs)
- **several clustering algorithms** with different assumptions of the data structure
  to create an ensemble of data partitions
- we combined this ensemble using different consensus functions and take the one
  that maximized the agreement with the ensemble


To ease **interpretation of clustering results**, we trained a decision tree
classifier on the cluster lavels using the raw input data (traits x LVs) to see
which LVs/modules are driving each cluster.

We choose and analyze **expected clusters**, and then **novel ones**.

Maybe we can incorporate **Binglan's TWAS results on PMBB** and see if expected
traits-clusters are correctly predicted.
:::


![
**Cluster analysis on traits.**
<!--  -->
**a)** Explain clustering steps.
<!--  -->
**b)** Explain interpretation steps.
<!--  -->
](images/clustering/clustering_design.svg?sanitize=true "Cluster analysis on
traits"){#fig:traits_clusters height=5in}


![
**Clustering tree of traits.**
<!--  -->
Explain.
<!--  -->
](images/clustering/clustering_tree.svg?sanitize=true "Cluster analysis on
traits"){#fig:traits_clusters height=5in}
