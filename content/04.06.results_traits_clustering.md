### Clusters of traits in the gene module space are affected by shared transcriptional processes

::: {style="color: red"}
The idea of this section is to use this latent space to find:

- which traits are affected by the same transcriptional processes, and
- the context (cell types/tissues) in which those processes are activated.

For the clustering analysis approach, we used a consensus clustering approach to
increase robustness of results:

- a **PCA** and a **UMAP** projection of the data (traits x LVs)
- **several clustering algorithms** with different assumptions of the data structure
  to create an ensemble of data partitions
- we combined this ensemble using different consensus functions and take the one
  that maximized the agreement with the ensemble


To ease **interpretation of clustering results**, we trained a decision tree
classifier on the cluster lavels using the raw input data (traits x LVs) to see
which LVs/modules are driving each cluster.

We choose and analyze **expected clusters**, and then **novel ones**.

Maybe we can incorporate **Binglan's TWAS results on PMBB** and see if expected
traits-clusters are correctly predicted.
:::


![
**Cluster analysis on traits.**
<!--  -->
**a)** Explain clustering steps.
<!--  -->
**b)** Explain interpretation steps.
<!--  -->
](images/clustering/clustering_design.svg?sanitize=true "Cluster analysis on
traits"){#fig:clusering:design height=5in}


All traits in PhenomeXcan were projected into the latent space learned from
recount2 using Equation (@eq:proj). We conducted cluster analysis using this new
representation to find groups of traits that are similarly affected by the same
transcriptional processes. To avoid using a single clustering algorithm (which
implies using a single assumption about the structure of the data), we employed
a consensus clustering approach where different methods with varying sets
parameters are applied on the same data, and later combined into a consolidated
solution [@doi:10.1016/j.ins.2016.04.027; @doi:10.1109/TPAMI.2005.237;
@Strehl2002] (Figure @fig:clusering:design).


![
**Clustering tree of traits.**
<!--  -->
Explain.
<!--  -->
](images/clustering/clustering_tree.svg?sanitize=true "Cluster analysis on
traits"){#fig:clustering:tree height=5in}
